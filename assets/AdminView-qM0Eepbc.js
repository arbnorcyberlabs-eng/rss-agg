import{d as x,r as w,c as A,s as F,_ as S,a as m,b as o,e as y,w as g,v as h,t as p,f as E,o as i,g as T,F as U,h as V,n as N,i as M,H as I,j as k,k as C,l as _,u as O}from"./index-ZUK0HHMi.js";const q=x("auth",()=>{const n=w(null),e=w(!1),a=A(()=>!!n.value);async function l(t,d){e.value=!0;try{const{data:f,error:v}=await F.auth.signInWithPassword({email:t,password:d});if(v)throw v;return n.value=f.user,f}catch(f){throw console.error("Login error:",f),f}finally{e.value=!1}}async function r(){e.value=!0;try{const{error:t}=await F.auth.signOut();if(t)throw t;n.value=null}catch(t){throw console.error("Logout error:",t),t}finally{e.value=!1}}async function s(){e.value=!0;try{const{data:{user:t}}=await F.auth.getUser();n.value=t}catch(t){console.error("Auth check error:",t),n.value=null}finally{e.value=!1}}return F.auth.onAuthStateChange((t,d)=>{n.value=(d==null?void 0:d.user)||null}),{user:n,loading:e,isAuthenticated:a,login:l,logout:r,checkAuth:s}}),B={name:"LoginForm",data(){return{email:"",password:"",loading:!1,error:null}},emits:["login"],methods:{async handleSubmit(){this.error=null,this.loading=!0;try{await this.$emit("login",{email:this.email,password:this.password})}catch(n){this.error=n.message||"Login failed"}finally{this.loading=!1}}}},H={class:"login-form"},J={class:"form-group"},R={class:"form-group"},$={key:0,class:"error-message"},j=["disabled"];function P(n,e,a,l,r,s){return i(),m("div",H,[e[5]||(e[5]=o("h2",null,"Admin Login",-1)),o("form",{onSubmit:e[2]||(e[2]=E((...t)=>s.handleSubmit&&s.handleSubmit(...t),["prevent"]))},[o("div",J,[e[3]||(e[3]=o("label",{for:"email"},"Email",-1)),g(o("input",{id:"email","onUpdate:modelValue":e[0]||(e[0]=t=>r.email=t),type:"email",placeholder:"admin@example.com",required:""},null,512),[[h,r.email]])]),o("div",R,[e[4]||(e[4]=o("label",{for:"password"},"Password",-1)),g(o("input",{id:"password","onUpdate:modelValue":e[1]||(e[1]=t=>r.password=t),type:"password",placeholder:"••••••••",required:""},null,512),[[h,r.password]])]),r.error?(i(),m("div",$,p(r.error),1)):y("",!0),o("button",{type:"submit",class:"submit-button",disabled:r.loading},p(r.loading?"Logging in...":"Login"),9,j)],32)])}const W=S(B,[["render",P],["__scopeId","data-v-6933e7af"]]),z={name:"FeedForm",props:{feed:{type:Object,default:null}},emits:["submit","cancel"],data(){return{formData:{id:"",title:"",type:"scraped",config:null,rss_url:null,display_order:0},configText:""}},computed:{isEdit(){return!!this.feed}},watch:{feed:{immediate:!0,handler(n){n&&(this.formData={...n},this.configText=n.config?JSON.stringify(n.config,null,2):"")}}},methods:{handleSubmit(){const n={...this.formData};if(n.type==="scraped")try{n.config=JSON.parse(this.configText),n.rss_url=null}catch{alert("Invalid JSON configuration");return}else n.config=null;this.$emit("submit",n)}}},G={class:"feed-form"},K={class:"form-group"},Q=["disabled"],X={class:"form-group"},Y={class:"form-group"},Z={key:0,class:"form-group"},ee={key:1,class:"form-group"},te={class:"form-group"},oe={class:"form-actions"},ne={type:"submit",class:"submit-button"};function re(n,e,a,l,r,s){return i(),m("div",G,[o("h3",null,p(s.isEdit?"Edit Feed":"Add New Feed"),1),o("form",{onSubmit:e[7]||(e[7]=E((...t)=>s.handleSubmit&&s.handleSubmit(...t),["prevent"]))},[o("div",K,[e[8]||(e[8]=o("label",{for:"feedId"},"Feed ID *",-1)),g(o("input",{id:"feedId","onUpdate:modelValue":e[0]||(e[0]=t=>r.formData.id=t),type:"text",disabled:s.isEdit,placeholder:"e.g., my-feed",required:""},null,8,Q),[[h,r.formData.id]])]),o("div",X,[e[9]||(e[9]=o("label",{for:"feedTitle"},"Title *",-1)),g(o("input",{id:"feedTitle","onUpdate:modelValue":e[1]||(e[1]=t=>r.formData.title=t),type:"text",placeholder:"e.g., My Awesome Feed",required:""},null,512),[[h,r.formData.title]])]),o("div",Y,[e[11]||(e[11]=o("label",{for:"feedType"},"Feed Type *",-1)),g(o("select",{id:"feedType","onUpdate:modelValue":e[2]||(e[2]=t=>r.formData.type=t),required:""},[...e[10]||(e[10]=[o("option",{value:"scraped"},"Scraped (Web Scraping)",-1),o("option",{value:"native_rss"},"Native RSS (Existing Feed URL)",-1)])],512),[[T,r.formData.type]])]),r.formData.type==="native_rss"?(i(),m("div",Z,[e[12]||(e[12]=o("label",{for:"rssUrl"},"RSS Feed URL *",-1)),g(o("input",{id:"rssUrl","onUpdate:modelValue":e[3]||(e[3]=t=>r.formData.rss_url=t),type:"url",placeholder:"https://example.com/feed.xml",required:""},null,512),[[h,r.formData.rss_url]])])):y("",!0),r.formData.type==="scraped"?(i(),m("div",ee,[e[13]||(e[13]=o("label",{for:"config"},"Configuration (JSON) *",-1)),g(o("textarea",{id:"config","onUpdate:modelValue":e[4]||(e[4]=t=>r.configText=t),rows:"10",placeholder:'{"url": "https://example.com", "entrySelector": ".item"}'},null,512),[[h,r.configText]])])):y("",!0),o("div",te,[e[14]||(e[14]=o("label",{for:"displayOrder"},"Display Order",-1)),g(o("input",{id:"displayOrder","onUpdate:modelValue":e[5]||(e[5]=t=>r.formData.display_order=t),type:"number",min:"0"},null,512),[[h,r.formData.display_order,void 0,{number:!0}]])]),o("div",oe,[o("button",ne,p(s.isEdit?"Update":"Create"),1),o("button",{type:"button",class:"cancel-button",onClick:e[6]||(e[6]=t=>n.$emit("cancel"))}," Cancel ")])],32)])}const le=S(z,[["render",re],["__scopeId","data-v-422ec400"]]),se={name:"FeedManager",props:{feeds:{type:Array,default:()=>[]}},emits:["toggle","edit","delete"],methods:{handleDelete(n){confirm(`Delete feed "${n.title}"?`)&&this.$emit("delete",n.id)}}},ie={class:"feed-manager"},ae={class:"feed-list"},de={class:"feed-info"},ue={class:"feed-meta"},me={class:"feed-actions"},fe=["onClick"],ce=["onClick"],ge=["onClick"],pe={key:0,class:"empty-state"};function he(n,e,a,l,r,s){return i(),m("div",ie,[e[1]||(e[1]=o("h3",null,"Manage Feeds",-1)),o("div",ae,[(i(!0),m(U,null,V(a.feeds,t=>(i(),m("div",{key:t.id,class:"feed-row"},[o("div",de,[o("strong",null,p(t.title),1),o("span",ue,p(t.id)+" · "+p(t.type),1)]),o("div",me,[o("button",{class:N(["toggle-button",{active:t.enabled}]),onClick:d=>n.$emit("toggle",t.id,!t.enabled)},p(t.enabled?"Enabled":"Disabled"),11,fe),o("button",{class:"edit-button",onClick:d=>n.$emit("edit",t)}," Edit ",8,ce),o("button",{class:"delete-button",onClick:d=>s.handleDelete(t)}," Delete ",8,ge)])]))),128))]),a.feeds.length===0?(i(),m("div",pe,[...e[0]||(e[0]=[o("p",null,"No feeds yet. Create your first feed!",-1)])])):y("",!0)])}const ve=S(se,[["render",he],["__scopeId","data-v-15779aa1"]]),ye={name:"AdminView",components:{Header:I,Footer:M,LoginForm:W,FeedForm:le,FeedManager:ve},setup(){const n=q(),e=O(),a=w(!1),l=w(null);async function r(u){try{await n.login(u.email,u.password),await e.loadFeeds()}catch(c){throw console.error("Login failed:",c),c}}async function s(){await n.logout()}function t(){l.value=null,a.value=!0}function d(u){l.value=u,a.value=!0}function f(){a.value=!1,l.value=null}async function v(u){try{l.value?await e.updateFeed(u.id,u):await e.addFeed(u),f()}catch(c){console.error("Error saving feed:",c),alert("Error saving feed: "+c.message)}}async function D(u,c){try{await e.toggleFeed(u,c)}catch(L){console.error("Error toggling feed:",L),alert("Error toggling feed: "+L.message)}}async function b(u){try{await e.deleteFeed(u)}catch(c){console.error("Error deleting feed:",c),alert("Error deleting feed: "+c.message)}}return n.isAuthenticated&&e.loadFeeds(),{authStore:n,feedStore:e,showForm:a,editingFeed:l,handleLogin:r,handleLogout:s,handleAdd:t,handleEdit:d,handleCancel:f,handleSubmit:v,handleToggle:D,handleDelete:b}}},be={class:"admin-view"},_e={key:1,class:"admin-panel"},Fe={class:"admin-header"};function we(n,e,a,l,r,s){const t=_("Header"),d=_("LoginForm"),f=_("FeedForm"),v=_("FeedManager"),D=_("Footer");return i(),m("div",be,[k(t),l.authStore.isAuthenticated?(i(),m("div",_e,[o("div",Fe,[e[2]||(e[2]=o("h2",null,"Feed Management",-1)),o("button",{class:"logout-button",onClick:e[0]||(e[0]=(...b)=>l.handleLogout&&l.handleLogout(...b))},"Logout")]),l.showForm?(i(),C(f,{key:0,feed:l.editingFeed,onSubmit:l.handleSubmit,onCancel:l.handleCancel},null,8,["feed","onSubmit","onCancel"])):y("",!0),l.showForm?y("",!0):(i(),m("button",{key:1,class:"add-button",onClick:e[1]||(e[1]=(...b)=>l.handleAdd&&l.handleAdd(...b))}," + Add New Feed ")),k(v,{feeds:l.feedStore.feeds,onToggle:l.handleToggle,onEdit:l.handleEdit,onDelete:l.handleDelete},null,8,["feeds","onToggle","onEdit","onDelete"])])):(i(),C(d,{key:0,onLogin:l.handleLogin},null,8,["onLogin"])),k(D)])}const De=S(ye,[["render",we],["__scopeId","data-v-323d625a"]]);export{De as default};
