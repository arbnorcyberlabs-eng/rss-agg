import{_ as D,c as a,b as t,t as p,k as y,w as g,v,l as w,m as A,j as r,d as T,e as U,n as x,F as R,H as V,a as _,p as C,r as c,q as S,s as L,u as M,f as N,h as E,i as q}from"./index-DH4cuTnY.js";import{A as I}from"./LoginForm-CbM5kVca.js";const $={name:"FeedForm",props:{feed:{type:Object,default:null}},emits:["submit","cancel"],data(){return{formData:{id:"",title:"",type:"native_rss",config:null,rss_url:null,display_order:0},configText:""}},computed:{isEdit(){return!!this.feed}},watch:{feed:{immediate:!0,handler(n){n&&(this.formData={...n},this.configText=n.config?JSON.stringify(n.config,null,2):"")}}},methods:{handleSubmit(){const n={...this.formData};if(n.type="native_rss",n.config=null,!n.rss_url){alert("RSS Feed URL is required for native RSS feeds");return}try{new URL(n.rss_url)}catch{alert("Please provide a valid RSS feed URL");return}this.$emit("submit",n)}}},O={class:"feed-form"},B={class:"form-group"},H=["disabled"],j={class:"form-group"},z={class:"form-group"},P={key:0,class:"form-group"},Y={class:"form-group"},J={class:"form-actions"},G={type:"submit",class:"submit-button"};function K(n,e,m,s,d,u){return r(),a("div",O,[t("h3",null,p(u.isEdit?"Edit Feed":"Add New Feed"),1),t("form",{onSubmit:e[6]||(e[6]=A((...o)=>u.handleSubmit&&u.handleSubmit(...o),["prevent"]))},[t("div",B,[e[7]||(e[7]=t("label",{for:"feedId"},"Feed ID *",-1)),g(t("input",{id:"feedId","onUpdate:modelValue":e[0]||(e[0]=o=>d.formData.id=o),type:"text",disabled:u.isEdit,placeholder:"e.g., my-feed",required:""},null,8,H),[[v,d.formData.id]])]),t("div",j,[e[8]||(e[8]=t("label",{for:"feedTitle"},"Title *",-1)),g(t("input",{id:"feedTitle","onUpdate:modelValue":e[1]||(e[1]=o=>d.formData.title=o),type:"text",placeholder:"e.g., My Awesome Feed",required:""},null,512),[[v,d.formData.title]])]),t("div",z,[e[10]||(e[10]=t("label",{for:"feedType"},"Feed Type *",-1)),g(t("select",{id:"feedType","onUpdate:modelValue":e[2]||(e[2]=o=>d.formData.type=o),required:""},[...e[9]||(e[9]=[t("option",{value:"native_rss"},"Native RSS (Existing Feed URL)",-1)])],512),[[w,d.formData.type]])]),d.formData.type==="native_rss"?(r(),a("div",P,[e[11]||(e[11]=t("label",{for:"rssUrl"},"RSS Feed URL *",-1)),g(t("input",{id:"rssUrl","onUpdate:modelValue":e[3]||(e[3]=o=>d.formData.rss_url=o),type:"url",placeholder:"https://example.com/feed.xml",required:""},null,512),[[v,d.formData.rss_url]])])):y("",!0),t("div",Y,[e[12]||(e[12]=t("label",{for:"displayOrder"},"Display Order",-1)),g(t("input",{id:"displayOrder","onUpdate:modelValue":e[4]||(e[4]=o=>d.formData.display_order=o),type:"number",min:"0"},null,512),[[v,d.formData.display_order,void 0,{number:!0}]])]),t("div",J,[t("button",G,p(u.isEdit?"Update":"Create"),1),t("button",{type:"button",class:"cancel-button",onClick:e[5]||(e[5]=o=>n.$emit("cancel"))}," Cancel ")])],32)])}const Q=D($,[["render",K],["__scopeId","data-v-186299e6"]]),W={name:"FeedManager",props:{feeds:{type:Array,default:()=>[]}},emits:["toggle","edit","delete"],methods:{handleDelete(n){confirm(`Delete feed "${n.title}"?`)&&this.$emit("delete",n.id)}}},X={class:"feed-manager"},Z={class:"feed-list"},ee={class:"feed-info"},te={class:"feed-meta"},oe={class:"feed-actions"},ne=["onClick"],se=["onClick"],de=["onClick"],re={key:0,class:"empty-state"};function le(n,e,m,s,d,u){return r(),a("div",X,[e[1]||(e[1]=t("h3",null,"Manage Feeds",-1)),t("div",Z,[(r(!0),a(T,null,U(m.feeds,o=>(r(),a("div",{key:o.id,class:"feed-row"},[t("div",ee,[t("strong",null,p(o.title),1),t("span",te,p(o.id)+" · "+p(o.type),1)]),t("div",oe,[t("button",{class:x(["toggle-button",{active:o.enabled}]),onClick:f=>n.$emit("toggle",o.id,!o.enabled)},p(o.enabled?"Enabled":"Disabled"),11,ne),t("button",{class:"edit-button",onClick:f=>n.$emit("edit",o)}," Edit ",8,se),t("button",{class:"delete-button",onClick:f=>u.handleDelete(o)}," Delete ",8,de)])]))),128))]),m.feeds.length===0?(r(),a("div",re,[...e[0]||(e[0]=[t("p",null,"No feeds yet. Create your first feed!",-1)])])):y("",!0)])}const ie=D(W,[["render",le],["__scopeId","data-v-15779aa1"]]),ae={name:"AdminView",components:{Header:V,Footer:R,AuthForm:I,FeedForm:Q,FeedManager:ie},setup(){q();const n=M(),e=N(),m=E(!1),s=E(null);async function d(){await n.logout()}function u(){s.value=null,m.value=!0}function o(l){s.value=l,m.value=!0}function f(){m.value=!1,s.value=null}async function h(l){try{s.value?await e.updateFeed(l.id,l):await e.addFeed(l),f()}catch(i){console.error("Error saving feed:",i),alert("Error saving feed: "+i.message)}}async function b(l,i){try{await e.toggleFeed(l,i)}catch(k){console.error("Error toggling feed:",k),alert("Error toggling feed: "+k.message)}}async function F(l){try{await e.deleteFeed(l)}catch(i){console.error("Error deleting feed:",i),alert("Error deleting feed: "+i.message)}}return n.isAuthenticated&&e.loadFeeds(),{authStore:n,feedStore:e,showForm:m,editingFeed:s,handleLogout:d,handleAdd:u,handleEdit:o,handleCancel:f,handleSubmit:h,handleToggle:b,handleDelete:F}}},ue={class:"admin-view"},me={key:1,class:"admin-panel"},fe={class:"admin-header"},ce={key:0,class:"restriction-message"},pe={key:1};function ge(n,e,m,s,d,u){const o=c("Header"),f=c("AuthForm"),h=c("router-link"),b=c("FeedForm"),F=c("FeedManager"),l=c("Footer");return r(),a("div",ue,[_(o),s.authStore.isAuthenticated?(r(),a("div",me,[t("div",fe,[e[2]||(e[2]=t("h2",null,"Feed Management",-1)),t("button",{class:"logout-button",onClick:e[0]||(e[0]=(...i)=>s.handleLogout&&s.handleLogout(...i))},"Logout")]),s.authStore.isAdmin?(r(),a("div",pe,[s.showForm?(r(),C(b,{key:0,feed:s.editingFeed,onSubmit:s.handleSubmit,onCancel:s.handleCancel},null,8,["feed","onSubmit","onCancel"])):y("",!0),s.showForm?y("",!0):(r(),a("button",{key:1,class:"add-button",onClick:e[1]||(e[1]=(...i)=>s.handleAdd&&s.handleAdd(...i))}," + Add New Feed ")),_(F,{feeds:s.feedStore.feeds,onToggle:s.handleToggle,onEdit:s.handleEdit,onDelete:s.handleDelete},null,8,["feeds","onToggle","onEdit","onDelete"])])):(r(),a("div",ce,[e[6]||(e[6]=t("p",null,"⚠️ You don't have admin access to manage feeds.",-1)),t("p",null,[e[4]||(e[4]=S("You can still customize your feed preferences in the ",-1)),_(h,{to:"/preferences"},{default:L(()=>[...e[3]||(e[3]=[S("Preferences",-1)])]),_:1}),e[5]||(e[5]=S(" page.",-1))])]))])):(r(),C(f,{key:0})),_(l)])}const ye=D(ae,[["render",ge],["__scopeId","data-v-69ad5088"]]);export{ye as default};
