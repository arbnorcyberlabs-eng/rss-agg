import{_ as D,c as l,b as t,t as g,k as v,w as c,v as y,l as w,m as x,j as d,d as A,e as T,n as N,F as V,H as U,a as _,p as C,r as p,q as S,s as M,u as O,f as I,h as E,i as L}from"./index-BIDwU2xi.js";import{A as q}from"./LoginForm-B4Vugzp1.js";const R={name:"FeedForm",props:{feed:{type:Object,default:null}},emits:["submit","cancel"],data(){return{formData:{id:"",title:"",type:"scraped",config:null,rss_url:null,display_order:0},configText:""}},computed:{isEdit(){return!!this.feed}},watch:{feed:{immediate:!0,handler(n){n&&(this.formData={...n},this.configText=n.config?JSON.stringify(n.config,null,2):"")}}},methods:{handleSubmit(){const n={...this.formData};if(n.type==="scraped")try{n.config=JSON.parse(this.configText),n.rss_url=null}catch{alert("Invalid JSON configuration");return}else n.config=null;this.$emit("submit",n)}}},B={class:"feed-form"},H={class:"form-group"},J=["disabled"],$={class:"form-group"},j={class:"form-group"},z={key:0,class:"form-group"},Y={key:1,class:"form-group"},P={class:"form-group"},W={class:"form-actions"},G={type:"submit",class:"submit-button"};function K(n,e,m,s,r,u){return d(),l("div",B,[t("h3",null,g(u.isEdit?"Edit Feed":"Add New Feed"),1),t("form",{onSubmit:e[7]||(e[7]=x((...o)=>u.handleSubmit&&u.handleSubmit(...o),["prevent"]))},[t("div",H,[e[8]||(e[8]=t("label",{for:"feedId"},"Feed ID *",-1)),c(t("input",{id:"feedId","onUpdate:modelValue":e[0]||(e[0]=o=>r.formData.id=o),type:"text",disabled:u.isEdit,placeholder:"e.g., my-feed",required:""},null,8,J),[[y,r.formData.id]])]),t("div",$,[e[9]||(e[9]=t("label",{for:"feedTitle"},"Title *",-1)),c(t("input",{id:"feedTitle","onUpdate:modelValue":e[1]||(e[1]=o=>r.formData.title=o),type:"text",placeholder:"e.g., My Awesome Feed",required:""},null,512),[[y,r.formData.title]])]),t("div",j,[e[11]||(e[11]=t("label",{for:"feedType"},"Feed Type *",-1)),c(t("select",{id:"feedType","onUpdate:modelValue":e[2]||(e[2]=o=>r.formData.type=o),required:""},[...e[10]||(e[10]=[t("option",{value:"scraped"},"Scraped (Web Scraping)",-1),t("option",{value:"native_rss"},"Native RSS (Existing Feed URL)",-1)])],512),[[w,r.formData.type]])]),r.formData.type==="native_rss"?(d(),l("div",z,[e[12]||(e[12]=t("label",{for:"rssUrl"},"RSS Feed URL *",-1)),c(t("input",{id:"rssUrl","onUpdate:modelValue":e[3]||(e[3]=o=>r.formData.rss_url=o),type:"url",placeholder:"https://example.com/feed.xml",required:""},null,512),[[y,r.formData.rss_url]])])):v("",!0),r.formData.type==="scraped"?(d(),l("div",Y,[e[13]||(e[13]=t("label",{for:"config"},"Configuration (JSON) *",-1)),c(t("textarea",{id:"config","onUpdate:modelValue":e[4]||(e[4]=o=>r.configText=o),rows:"10",placeholder:'{"url": "https://example.com", "entrySelector": ".item"}'},null,512),[[y,r.configText]])])):v("",!0),t("div",P,[e[14]||(e[14]=t("label",{for:"displayOrder"},"Display Order",-1)),c(t("input",{id:"displayOrder","onUpdate:modelValue":e[5]||(e[5]=o=>r.formData.display_order=o),type:"number",min:"0"},null,512),[[y,r.formData.display_order,void 0,{number:!0}]])]),t("div",W,[t("button",G,g(u.isEdit?"Update":"Create"),1),t("button",{type:"button",class:"cancel-button",onClick:e[6]||(e[6]=o=>n.$emit("cancel"))}," Cancel ")])],32)])}const Q=D(R,[["render",K],["__scopeId","data-v-422ec400"]]),X={name:"FeedManager",props:{feeds:{type:Array,default:()=>[]}},emits:["toggle","edit","delete"],methods:{handleDelete(n){confirm(`Delete feed "${n.title}"?`)&&this.$emit("delete",n.id)}}},Z={class:"feed-manager"},ee={class:"feed-list"},te={class:"feed-info"},oe={class:"feed-meta"},ne={class:"feed-actions"},se=["onClick"],re=["onClick"],de=["onClick"],le={key:0,class:"empty-state"};function ie(n,e,m,s,r,u){return d(),l("div",Z,[e[1]||(e[1]=t("h3",null,"Manage Feeds",-1)),t("div",ee,[(d(!0),l(A,null,T(m.feeds,o=>(d(),l("div",{key:o.id,class:"feed-row"},[t("div",te,[t("strong",null,g(o.title),1),t("span",oe,g(o.id)+" · "+g(o.type),1)]),t("div",ne,[t("button",{class:N(["toggle-button",{active:o.enabled}]),onClick:f=>n.$emit("toggle",o.id,!o.enabled)},g(o.enabled?"Enabled":"Disabled"),11,se),t("button",{class:"edit-button",onClick:f=>n.$emit("edit",o)}," Edit ",8,re),t("button",{class:"delete-button",onClick:f=>u.handleDelete(o)}," Delete ",8,de)])]))),128))]),m.feeds.length===0?(d(),l("div",le,[...e[0]||(e[0]=[t("p",null,"No feeds yet. Create your first feed!",-1)])])):v("",!0)])}const ae=D(X,[["render",ie],["__scopeId","data-v-15779aa1"]]),ue={name:"AdminView",components:{Header:U,Footer:V,AuthForm:q,FeedForm:Q,FeedManager:ae},setup(){L();const n=O(),e=I(),m=E(!1),s=E(null);async function r(){await n.logout()}function u(){s.value=null,m.value=!0}function o(i){s.value=i,m.value=!0}function f(){m.value=!1,s.value=null}async function b(i){try{s.value?await e.updateFeed(i.id,i):await e.addFeed(i),f()}catch(a){console.error("Error saving feed:",a),alert("Error saving feed: "+a.message)}}async function h(i,a){try{await e.toggleFeed(i,a)}catch(k){console.error("Error toggling feed:",k),alert("Error toggling feed: "+k.message)}}async function F(i){try{await e.deleteFeed(i)}catch(a){console.error("Error deleting feed:",a),alert("Error deleting feed: "+a.message)}}return n.isAuthenticated&&e.loadFeeds(),{authStore:n,feedStore:e,showForm:m,editingFeed:s,handleLogout:r,handleAdd:u,handleEdit:o,handleCancel:f,handleSubmit:b,handleToggle:h,handleDelete:F}}},me={class:"admin-view"},fe={key:1,class:"admin-panel"},ce={class:"admin-header"},pe={key:0,class:"restriction-message"},ge={key:1};function ye(n,e,m,s,r,u){const o=p("Header"),f=p("AuthForm"),b=p("router-link"),h=p("FeedForm"),F=p("FeedManager"),i=p("Footer");return d(),l("div",me,[_(o),s.authStore.isAuthenticated?(d(),l("div",fe,[t("div",ce,[e[2]||(e[2]=t("h2",null,"Feed Management",-1)),t("button",{class:"logout-button",onClick:e[0]||(e[0]=(...a)=>s.handleLogout&&s.handleLogout(...a))},"Logout")]),s.authStore.isAdmin?(d(),l("div",ge,[s.showForm?(d(),C(h,{key:0,feed:s.editingFeed,onSubmit:s.handleSubmit,onCancel:s.handleCancel},null,8,["feed","onSubmit","onCancel"])):v("",!0),s.showForm?v("",!0):(d(),l("button",{key:1,class:"add-button",onClick:e[1]||(e[1]=(...a)=>s.handleAdd&&s.handleAdd(...a))}," + Add New Feed ")),_(F,{feeds:s.feedStore.feeds,onToggle:s.handleToggle,onEdit:s.handleEdit,onDelete:s.handleDelete},null,8,["feeds","onToggle","onEdit","onDelete"])])):(d(),l("div",pe,[e[6]||(e[6]=t("p",null,"⚠️ You don't have admin access to manage feeds.",-1)),t("p",null,[e[4]||(e[4]=S("You can still customize your feed preferences in the ",-1)),_(b,{to:"/preferences"},{default:M(()=>[...e[3]||(e[3]=[S("Preferences",-1)])]),_:1}),e[5]||(e[5]=S(" page.",-1))])]))])):(d(),C(f,{key:0})),_(i)])}const be=D(ue,[["render",ye],["__scopeId","data-v-69ad5088"]]);export{be as default};
