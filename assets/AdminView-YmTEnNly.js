import{_ as v,u as x,i as A,c as r,b as t,t as m,k as p,w as f,v as g,l as N,j as l,m as E,d as T,e as U,n as V,F as M,H as L,a as b,p as D,r as y,q as w,s as I,f as q,h as C}from"./index-CDJbn3Ba.js";const O={name:"AuthForm",setup(){const n=x(),e=A();return{authStore:n,router:e}},data(){return{isSignup:!1,email:"",password:"",fullName:"",loading:!1,error:null,success:null}},methods:{async handleSubmit(){this.error=null,this.success=null,this.loading=!0;try{this.isSignup?(await this.authStore.signup(this.email,this.password,this.fullName)).needsConfirmation?(this.success="✅ Account created! Please check your email to confirm your account before logging in.",this.email="",this.password="",this.fullName=""):(this.success="✅ Account created! You can now use all features.",setTimeout(()=>{this.router.push("/")},1500)):(await this.authStore.login(this.email,this.password),this.success="✅ Login successful! Redirecting...",setTimeout(()=>{this.router.push("/")},1e3))}catch(n){console.error("Auth error:",n);let e=n.message||(this.isSignup?"Signup failed":"Login failed");e.includes("Email not confirmed")?e="⚠️ Please confirm your email address before logging in. Check your inbox for the confirmation link.":e.includes("Invalid login credentials")?e="⚠️ Invalid email or password. Please try again.":e.includes("User already registered")&&(e="⚠️ This email is already registered. Please login instead."),this.error=e}finally{this.loading=!1}},toggleMode(){this.isSignup=!this.isSignup,this.error=null,this.success=null,this.email="",this.password="",this.fullName=""}}},P={class:"auth-form"},R={key:0,class:"form-group"},J={class:"form-group"},B=["placeholder"],H={class:"form-group"},Y=["minlength"],j={key:1,class:"error-message"},z={key:2,class:"success-message"},W=["disabled"],G={class:"toggle-mode"};function K(n,e,c,i,s,d){return l(),r("div",P,[t("h2",null,m(s.isSignup?"Create Account":"Login"),1),t("form",{onSubmit:e[3]||(e[3]=N((...o)=>d.handleSubmit&&d.handleSubmit(...o),["prevent"]))},[s.isSignup?(l(),r("div",R,[e[5]||(e[5]=t("label",{for:"fullName"},"Full Name",-1)),f(t("input",{id:"fullName","onUpdate:modelValue":e[0]||(e[0]=o=>s.fullName=o),type:"text",placeholder:"John Doe",required:""},null,512),[[g,s.fullName]])])):p("",!0),t("div",J,[e[6]||(e[6]=t("label",{for:"email"},"Email",-1)),f(t("input",{id:"email","onUpdate:modelValue":e[1]||(e[1]=o=>s.email=o),type:"email",placeholder:s.isSignup?"you@example.com":"admin@example.com",required:""},null,8,B),[[g,s.email]])]),t("div",H,[e[7]||(e[7]=t("label",{for:"password"},"Password",-1)),f(t("input",{id:"password","onUpdate:modelValue":e[2]||(e[2]=o=>s.password=o),type:"password",placeholder:"••••••••",minlength:s.isSignup?6:void 0,required:""},null,8,Y),[[g,s.password]])]),s.error?(l(),r("div",j,m(s.error),1)):p("",!0),s.success?(l(),r("div",z,m(s.success),1)):p("",!0),t("button",{type:"submit",class:"submit-button",disabled:s.loading},m(s.loading?"Processing...":s.isSignup?"Sign Up":"Login"),9,W)],32),t("div",G,[t("button",{type:"button",class:"toggle-button",onClick:e[4]||(e[4]=(...o)=>d.toggleMode&&d.toggleMode(...o))},m(s.isSignup?"Already have an account? Login":"Need an account? Sign up"),1)])])}const Q=v(O,[["render",K],["__scopeId","data-v-1a35fc43"]]),X={name:"FeedForm",props:{feed:{type:Object,default:null}},emits:["submit","cancel"],data(){return{formData:{id:"",title:"",type:"scraped",config:null,rss_url:null,display_order:0},configText:""}},computed:{isEdit(){return!!this.feed}},watch:{feed:{immediate:!0,handler(n){n&&(this.formData={...n},this.configText=n.config?JSON.stringify(n.config,null,2):"")}}},methods:{handleSubmit(){const n={...this.formData};if(n.type==="scraped")try{n.config=JSON.parse(this.configText),n.rss_url=null}catch{alert("Invalid JSON configuration");return}else n.config=null;this.$emit("submit",n)}}},Z={class:"feed-form"},$={class:"form-group"},ee=["disabled"],te={class:"form-group"},oe={class:"form-group"},se={key:0,class:"form-group"},ne={key:1,class:"form-group"},ie={class:"form-group"},le={class:"form-actions"},re={type:"submit",class:"submit-button"};function de(n,e,c,i,s,d){return l(),r("div",Z,[t("h3",null,m(d.isEdit?"Edit Feed":"Add New Feed"),1),t("form",{onSubmit:e[7]||(e[7]=N((...o)=>d.handleSubmit&&d.handleSubmit(...o),["prevent"]))},[t("div",$,[e[8]||(e[8]=t("label",{for:"feedId"},"Feed ID *",-1)),f(t("input",{id:"feedId","onUpdate:modelValue":e[0]||(e[0]=o=>s.formData.id=o),type:"text",disabled:d.isEdit,placeholder:"e.g., my-feed",required:""},null,8,ee),[[g,s.formData.id]])]),t("div",te,[e[9]||(e[9]=t("label",{for:"feedTitle"},"Title *",-1)),f(t("input",{id:"feedTitle","onUpdate:modelValue":e[1]||(e[1]=o=>s.formData.title=o),type:"text",placeholder:"e.g., My Awesome Feed",required:""},null,512),[[g,s.formData.title]])]),t("div",oe,[e[11]||(e[11]=t("label",{for:"feedType"},"Feed Type *",-1)),f(t("select",{id:"feedType","onUpdate:modelValue":e[2]||(e[2]=o=>s.formData.type=o),required:""},[...e[10]||(e[10]=[t("option",{value:"scraped"},"Scraped (Web Scraping)",-1),t("option",{value:"native_rss"},"Native RSS (Existing Feed URL)",-1)])],512),[[E,s.formData.type]])]),s.formData.type==="native_rss"?(l(),r("div",se,[e[12]||(e[12]=t("label",{for:"rssUrl"},"RSS Feed URL *",-1)),f(t("input",{id:"rssUrl","onUpdate:modelValue":e[3]||(e[3]=o=>s.formData.rss_url=o),type:"url",placeholder:"https://example.com/feed.xml",required:""},null,512),[[g,s.formData.rss_url]])])):p("",!0),s.formData.type==="scraped"?(l(),r("div",ne,[e[13]||(e[13]=t("label",{for:"config"},"Configuration (JSON) *",-1)),f(t("textarea",{id:"config","onUpdate:modelValue":e[4]||(e[4]=o=>s.configText=o),rows:"10",placeholder:'{"url": "https://example.com", "entrySelector": ".item"}'},null,512),[[g,s.configText]])])):p("",!0),t("div",ie,[e[14]||(e[14]=t("label",{for:"displayOrder"},"Display Order",-1)),f(t("input",{id:"displayOrder","onUpdate:modelValue":e[5]||(e[5]=o=>s.formData.display_order=o),type:"number",min:"0"},null,512),[[g,s.formData.display_order,void 0,{number:!0}]])]),t("div",le,[t("button",re,m(d.isEdit?"Update":"Create"),1),t("button",{type:"button",class:"cancel-button",onClick:e[6]||(e[6]=o=>n.$emit("cancel"))}," Cancel ")])],32)])}const ae=v(X,[["render",de],["__scopeId","data-v-422ec400"]]),ue={name:"FeedManager",props:{feeds:{type:Array,default:()=>[]}},emits:["toggle","edit","delete"],methods:{handleDelete(n){confirm(`Delete feed "${n.title}"?`)&&this.$emit("delete",n.id)}}},me={class:"feed-manager"},ce={class:"feed-list"},fe={class:"feed-info"},ge={class:"feed-meta"},pe={class:"feed-actions"},he=["onClick"],ye=["onClick"],be=["onClick"],ve={key:0,class:"empty-state"};function _e(n,e,c,i,s,d){return l(),r("div",me,[e[1]||(e[1]=t("h3",null,"Manage Feeds",-1)),t("div",ce,[(l(!0),r(T,null,U(c.feeds,o=>(l(),r("div",{key:o.id,class:"feed-row"},[t("div",fe,[t("strong",null,m(o.title),1),t("span",ge,m(o.id)+" · "+m(o.type),1)]),t("div",pe,[t("button",{class:V(["toggle-button",{active:o.enabled}]),onClick:h=>n.$emit("toggle",o.id,!o.enabled)},m(o.enabled?"Enabled":"Disabled"),11,he),t("button",{class:"edit-button",onClick:h=>n.$emit("edit",o)}," Edit ",8,ye),t("button",{class:"delete-button",onClick:h=>d.handleDelete(o)}," Delete ",8,be)])]))),128))]),c.feeds.length===0?(l(),r("div",ve,[...e[0]||(e[0]=[t("p",null,"No feeds yet. Create your first feed!",-1)])])):p("",!0)])}const Se=v(ue,[["render",_e],["__scopeId","data-v-15779aa1"]]),Fe={name:"AdminView",components:{Header:L,Footer:M,AuthForm:Q,FeedForm:ae,FeedManager:Se},setup(){A();const n=x(),e=q(),c=C(!1),i=C(null);async function s(){await n.logout()}function d(){i.value=null,c.value=!0}function o(a){i.value=a,c.value=!0}function h(){c.value=!1,i.value=null}async function _(a){try{i.value?await e.updateFeed(a.id,a):await e.addFeed(a),h()}catch(u){console.error("Error saving feed:",u),alert("Error saving feed: "+u.message)}}async function S(a,u){try{await e.toggleFeed(a,u)}catch(k){console.error("Error toggling feed:",k),alert("Error toggling feed: "+k.message)}}async function F(a){try{await e.deleteFeed(a)}catch(u){console.error("Error deleting feed:",u),alert("Error deleting feed: "+u.message)}}return n.isAuthenticated&&e.loadFeeds(),{authStore:n,feedStore:e,showForm:c,editingFeed:i,handleLogout:s,handleAdd:d,handleEdit:o,handleCancel:h,handleSubmit:_,handleToggle:S,handleDelete:F}}},we={class:"admin-view"},ke={key:1,class:"admin-panel"},De={class:"admin-header"},Ce={key:0,class:"restriction-message"},xe={key:1};function Ae(n,e,c,i,s,d){const o=y("Header"),h=y("AuthForm"),_=y("router-link"),S=y("FeedForm"),F=y("FeedManager"),a=y("Footer");return l(),r("div",we,[b(o),i.authStore.isAuthenticated?(l(),r("div",ke,[t("div",De,[e[2]||(e[2]=t("h2",null,"Feed Management",-1)),t("button",{class:"logout-button",onClick:e[0]||(e[0]=(...u)=>i.handleLogout&&i.handleLogout(...u))},"Logout")]),i.authStore.isAdmin?(l(),r("div",xe,[i.showForm?(l(),D(S,{key:0,feed:i.editingFeed,onSubmit:i.handleSubmit,onCancel:i.handleCancel},null,8,["feed","onSubmit","onCancel"])):p("",!0),i.showForm?p("",!0):(l(),r("button",{key:1,class:"add-button",onClick:e[1]||(e[1]=(...u)=>i.handleAdd&&i.handleAdd(...u))}," + Add New Feed ")),b(F,{feeds:i.feedStore.feeds,onToggle:i.handleToggle,onEdit:i.handleEdit,onDelete:i.handleDelete},null,8,["feeds","onToggle","onEdit","onDelete"])])):(l(),r("div",Ce,[e[6]||(e[6]=t("p",null,"⚠️ You don't have admin access to manage feeds.",-1)),t("p",null,[e[4]||(e[4]=w("You can still customize your feed preferences in the ",-1)),b(_,{to:"/preferences"},{default:I(()=>[...e[3]||(e[3]=[w("Preferences",-1)])]),_:1}),e[5]||(e[5]=w(" page.",-1))])]))])):(l(),D(h,{key:0})),b(a)])}const Ee=v(Fe,[["render",Ae],["__scopeId","data-v-69ad5088"]]);export{Ee as default};
