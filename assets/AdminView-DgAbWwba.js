import{_,c as d,b as t,t as u,k as c,w as g,v as p,l as x,j as l,m as A,d as E,e as T,n as L,F as U,H as V,a as v,p as C,r as y,q as k,s as M,u as q,f as I,h as N,i as O}from"./index-C6hVFQmr.js";const J={name:"AuthForm",data(){return{isSignup:!1,email:"",password:"",fullName:"",loading:!1,error:null,success:null}},emits:["login","signup"],methods:{async handleSubmit(){this.error=null,this.success=null,this.loading=!0;try{this.isSignup?(await this.$emit("signup",{email:this.email,password:this.password,fullName:this.fullName}),this.success="Account created! You can now use all features."):await this.$emit("login",{email:this.email,password:this.password})}catch(n){this.error=n.message||(this.isSignup?"Signup failed":"Login failed")}finally{this.loading=!1}},toggleMode(){this.isSignup=!this.isSignup,this.error=null,this.success=null,this.email="",this.password="",this.fullName=""}}},R={class:"auth-form"},B={key:0,class:"form-group"},H={class:"form-group"},P=["placeholder"],Y={class:"form-group"},j=["minlength"],z={key:1,class:"error-message"},W={key:2,class:"success-message"},G=["disabled"],K={class:"toggle-mode"};function Q(n,e,m,i,s,a){return l(),d("div",R,[t("h2",null,u(s.isSignup?"Create Account":"Login"),1),t("form",{onSubmit:e[3]||(e[3]=x((...o)=>a.handleSubmit&&a.handleSubmit(...o),["prevent"]))},[s.isSignup?(l(),d("div",B,[e[5]||(e[5]=t("label",{for:"fullName"},"Full Name",-1)),g(t("input",{id:"fullName","onUpdate:modelValue":e[0]||(e[0]=o=>s.fullName=o),type:"text",placeholder:"John Doe",required:""},null,512),[[p,s.fullName]])])):c("",!0),t("div",H,[e[6]||(e[6]=t("label",{for:"email"},"Email",-1)),g(t("input",{id:"email","onUpdate:modelValue":e[1]||(e[1]=o=>s.email=o),type:"email",placeholder:s.isSignup?"you@example.com":"admin@example.com",required:""},null,8,P),[[p,s.email]])]),t("div",Y,[e[7]||(e[7]=t("label",{for:"password"},"Password",-1)),g(t("input",{id:"password","onUpdate:modelValue":e[2]||(e[2]=o=>s.password=o),type:"password",placeholder:"••••••••",minlength:s.isSignup?6:void 0,required:""},null,8,j),[[p,s.password]])]),s.error?(l(),d("div",z,u(s.error),1)):c("",!0),s.success?(l(),d("div",W,u(s.success),1)):c("",!0),t("button",{type:"submit",class:"submit-button",disabled:s.loading},u(s.loading?"Processing...":s.isSignup?"Sign Up":"Login"),9,G)],32),t("div",K,[t("button",{type:"button",class:"toggle-button",onClick:e[4]||(e[4]=(...o)=>a.toggleMode&&a.toggleMode(...o))},u(s.isSignup?"Already have an account? Login":"Need an account? Sign up"),1)])])}const X=_(J,[["render",Q],["__scopeId","data-v-da47efde"]]),Z={name:"FeedForm",props:{feed:{type:Object,default:null}},emits:["submit","cancel"],data(){return{formData:{id:"",title:"",type:"scraped",config:null,rss_url:null,display_order:0},configText:""}},computed:{isEdit(){return!!this.feed}},watch:{feed:{immediate:!0,handler(n){n&&(this.formData={...n},this.configText=n.config?JSON.stringify(n.config,null,2):"")}}},methods:{handleSubmit(){const n={...this.formData};if(n.type==="scraped")try{n.config=JSON.parse(this.configText),n.rss_url=null}catch{alert("Invalid JSON configuration");return}else n.config=null;this.$emit("submit",n)}}},$={class:"feed-form"},ee={class:"form-group"},te=["disabled"],oe={class:"form-group"},se={class:"form-group"},ne={key:0,class:"form-group"},ie={key:1,class:"form-group"},le={class:"form-group"},re={class:"form-actions"},de={type:"submit",class:"submit-button"};function ae(n,e,m,i,s,a){return l(),d("div",$,[t("h3",null,u(a.isEdit?"Edit Feed":"Add New Feed"),1),t("form",{onSubmit:e[7]||(e[7]=x((...o)=>a.handleSubmit&&a.handleSubmit(...o),["prevent"]))},[t("div",ee,[e[8]||(e[8]=t("label",{for:"feedId"},"Feed ID *",-1)),g(t("input",{id:"feedId","onUpdate:modelValue":e[0]||(e[0]=o=>s.formData.id=o),type:"text",disabled:a.isEdit,placeholder:"e.g., my-feed",required:""},null,8,te),[[p,s.formData.id]])]),t("div",oe,[e[9]||(e[9]=t("label",{for:"feedTitle"},"Title *",-1)),g(t("input",{id:"feedTitle","onUpdate:modelValue":e[1]||(e[1]=o=>s.formData.title=o),type:"text",placeholder:"e.g., My Awesome Feed",required:""},null,512),[[p,s.formData.title]])]),t("div",se,[e[11]||(e[11]=t("label",{for:"feedType"},"Feed Type *",-1)),g(t("select",{id:"feedType","onUpdate:modelValue":e[2]||(e[2]=o=>s.formData.type=o),required:""},[...e[10]||(e[10]=[t("option",{value:"scraped"},"Scraped (Web Scraping)",-1),t("option",{value:"native_rss"},"Native RSS (Existing Feed URL)",-1)])],512),[[A,s.formData.type]])]),s.formData.type==="native_rss"?(l(),d("div",ne,[e[12]||(e[12]=t("label",{for:"rssUrl"},"RSS Feed URL *",-1)),g(t("input",{id:"rssUrl","onUpdate:modelValue":e[3]||(e[3]=o=>s.formData.rss_url=o),type:"url",placeholder:"https://example.com/feed.xml",required:""},null,512),[[p,s.formData.rss_url]])])):c("",!0),s.formData.type==="scraped"?(l(),d("div",ie,[e[13]||(e[13]=t("label",{for:"config"},"Configuration (JSON) *",-1)),g(t("textarea",{id:"config","onUpdate:modelValue":e[4]||(e[4]=o=>s.configText=o),rows:"10",placeholder:'{"url": "https://example.com", "entrySelector": ".item"}'},null,512),[[p,s.configText]])])):c("",!0),t("div",le,[e[14]||(e[14]=t("label",{for:"displayOrder"},"Display Order",-1)),g(t("input",{id:"displayOrder","onUpdate:modelValue":e[5]||(e[5]=o=>s.formData.display_order=o),type:"number",min:"0"},null,512),[[p,s.formData.display_order,void 0,{number:!0}]])]),t("div",re,[t("button",de,u(a.isEdit?"Update":"Create"),1),t("button",{type:"button",class:"cancel-button",onClick:e[6]||(e[6]=o=>n.$emit("cancel"))}," Cancel ")])],32)])}const ue=_(Z,[["render",ae],["__scopeId","data-v-422ec400"]]),me={name:"FeedManager",props:{feeds:{type:Array,default:()=>[]}},emits:["toggle","edit","delete"],methods:{handleDelete(n){confirm(`Delete feed "${n.title}"?`)&&this.$emit("delete",n.id)}}},fe={class:"feed-manager"},ge={class:"feed-list"},pe={class:"feed-info"},ce={class:"feed-meta"},he={class:"feed-actions"},ye=["onClick"],be=["onClick"],ve=["onClick"],_e={key:0,class:"empty-state"};function Se(n,e,m,i,s,a){return l(),d("div",fe,[e[1]||(e[1]=t("h3",null,"Manage Feeds",-1)),t("div",ge,[(l(!0),d(E,null,T(m.feeds,o=>(l(),d("div",{key:o.id,class:"feed-row"},[t("div",pe,[t("strong",null,u(o.title),1),t("span",ce,u(o.id)+" · "+u(o.type),1)]),t("div",he,[t("button",{class:L(["toggle-button",{active:o.enabled}]),onClick:h=>n.$emit("toggle",o.id,!o.enabled)},u(o.enabled?"Enabled":"Disabled"),11,ye),t("button",{class:"edit-button",onClick:h=>n.$emit("edit",o)}," Edit ",8,be),t("button",{class:"delete-button",onClick:h=>a.handleDelete(o)}," Delete ",8,ve)])]))),128))]),m.feeds.length===0?(l(),d("div",_e,[...e[0]||(e[0]=[t("p",null,"No feeds yet. Create your first feed!",-1)])])):c("",!0)])}const Fe=_(me,[["render",Se],["__scopeId","data-v-15779aa1"]]),we={name:"AdminView",components:{Header:V,Footer:U,AuthForm:X,FeedForm:ue,FeedManager:Fe},setup(){O();const n=q(),e=I(),m=N(!1),i=N(null);async function s(r){try{await n.login(r.email,r.password),await e.loadFeeds()}catch(f){throw console.error("Login failed:",f),f}}async function a(){await n.logout()}function o(){i.value=null,m.value=!0}function h(r){i.value=r,m.value=!0}function b(){m.value=!1,i.value=null}async function S(r){try{i.value?await e.updateFeed(r.id,r):await e.addFeed(r),b()}catch(f){console.error("Error saving feed:",f),alert("Error saving feed: "+f.message)}}async function F(r,f){try{await e.toggleFeed(r,f)}catch(D){console.error("Error toggling feed:",D),alert("Error toggling feed: "+D.message)}}async function w(r){try{await e.deleteFeed(r)}catch(f){console.error("Error deleting feed:",f),alert("Error deleting feed: "+f.message)}}return n.isAuthenticated&&e.loadFeeds(),{authStore:n,feedStore:e,showForm:m,editingFeed:i,handleLogin:s,handleLogout:a,handleAdd:o,handleEdit:h,handleCancel:b,handleSubmit:S,handleToggle:F,handleDelete:w}}},ke={class:"admin-view"},De={key:1,class:"admin-panel"},Ce={class:"admin-header"},Ne={key:0,class:"restriction-message"},xe={key:1};function Ae(n,e,m,i,s,a){const o=y("Header"),h=y("AuthForm"),b=y("router-link"),S=y("FeedForm"),F=y("FeedManager"),w=y("Footer");return l(),d("div",ke,[v(o),i.authStore.isAuthenticated?(l(),d("div",De,[t("div",Ce,[e[2]||(e[2]=t("h2",null,"Feed Management",-1)),t("button",{class:"logout-button",onClick:e[0]||(e[0]=(...r)=>i.handleLogout&&i.handleLogout(...r))},"Logout")]),i.authStore.isAdmin?(l(),d("div",xe,[i.showForm?(l(),C(S,{key:0,feed:i.editingFeed,onSubmit:i.handleSubmit,onCancel:i.handleCancel},null,8,["feed","onSubmit","onCancel"])):c("",!0),i.showForm?c("",!0):(l(),d("button",{key:1,class:"add-button",onClick:e[1]||(e[1]=(...r)=>i.handleAdd&&i.handleAdd(...r))}," + Add New Feed ")),v(F,{feeds:i.feedStore.feeds,onToggle:i.handleToggle,onEdit:i.handleEdit,onDelete:i.handleDelete},null,8,["feeds","onToggle","onEdit","onDelete"])])):(l(),d("div",Ne,[e[6]||(e[6]=t("p",null,"⚠️ You don't have admin access to manage feeds.",-1)),t("p",null,[e[4]||(e[4]=k("You can still customize your feed preferences in the ",-1)),v(b,{to:"/preferences"},{default:M(()=>[...e[3]||(e[3]=[k("Preferences",-1)])]),_:1}),e[5]||(e[5]=k(" page.",-1))])]))])):(l(),C(h,{key:0,onLogin:i.handleLogin,onSignup:n.handleSignup},null,8,["onLogin","onSignup"])),v(w)])}const Te=_(we,[["render",Ae],["__scopeId","data-v-e25a02a1"]]);export{Te as default};
